<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Svc/Deframer/docs/sdd.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F´ Flight Software - C/C++ Documentation
   &#160;<span id="projectnumber">NASA-v1.6.0</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_svc_2_deframer_2docs_2sdd_8md.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Svc/Deframer/docs/sdd.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_svc_2_deframer_2docs_2sdd_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;\page SvcDeframer Deframer Component</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;# Svc::Deframer Deframer Component</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Deframer takes a stream of bytes from ground, checks the header and footer, and then extracts message data from the stream. The extracted data usually is passed to the service layer (typically CmdDisp, FileUplink, or a GenericHub). The Deframer uses a `DeframingProtocol` for the same abstraction that the Framer uses `FramingProtocol`. Deframer is backed by a circular buffer such that incomplete messages are reassembled. It also can be hooked up in two ways: </div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;1. Polling (for drivers without their own thread/scheduling): In this configuration Deframer will poll the driver looking for new data.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;2. Callback (for drivers with a thread/scheduling): In this configuration the driver pushes data to the Deframer.</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Note: User should hook up only one of the configurations at a time.</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;## Design</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;1. Deframer will accept incoming buffers.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;2. Upon buffer receipt, it will delegate processing to a `DeframingInstance`.</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    1. If that delegation returns an error, it will discard the first byte and keep processing.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    2. If that delegation returns need more status, it will accumulate more buffers until it has the size specified, and then rerun the processing.</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    3. If that delegation returns success, it will discard `size` bytes and start at the next message.</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;3. When a `route` call is called-back to the Deframer, it will send the message to the `Fw::Com` output port of the `Fw::Buffer` output port based on the specified type in the route call.</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;4. If an allocate callback is made, it will delegate that allocation to the bufferAllocate call.</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;5. If step three is routing to `Fw::Com`, it must pass the buffer to the `bufferDeallocate` port.</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;## Usage Examples</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;When Deframer component receives the data from a manager component (typically a service layer such as ground uplinkComm or TcpClient) via polling or a callback, the Deframer will perform the deserialization per `DeframingProtocol` and will transfer the stream via `bufferOut` or `comOut` port to components such as `CmdDisp`, `FileUplink`, or a `GenericHub`.</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;The following diagram is an example of Deframer usage with and `uplinkComm` component:</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;![framer_example](./img/deframer_example_1.png)</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;The following diagram is an example of Deframer usage with a `TcpClient` and `GenericHub` component:</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;![framer_example](./img/deframer_example_2.png)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;The following is a typical Deframing setup:</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;```c++</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;Svc::FprimeDeframing deframing_obj; // Deframing protocol obj;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;Svc::DeframerComponentImpl uplink_obj(&quot;Deframer&quot;); // Deframer obj</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;uplink_obj.init(0);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;uplink_obj.setup(deframing_obj);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;```</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;## Class Diagram</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;![classdiagram](./img/class_diagram_deframer.png)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;## Requirements</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;| Name | Description | Validation |</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;|---|---|---|</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;| TBD | TBD | TBD |</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;## Change Log</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;| Date | Description |</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;|---|---|</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;| 2021-01-30 | Initial Draft |</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_svc_2_deframer_2docs_2sdd_8md.html">sdd.md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
